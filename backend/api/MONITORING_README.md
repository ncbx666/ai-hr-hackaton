# –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Google Sheets

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π —Å Google Sheets –≤ AI-HR –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –≤–∫–ª—é—á–∞—è:

- üìä **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚ö° **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** —Å –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- üö® **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫** —Å –ø–æ–ª–Ω—ã–º–∏ stack trace
- üìà **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** –æ–ø–µ—Ä–∞—Ü–∏–π
- üîç **API –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **GoogleSheetsMonitor** (`google_sheets_monitor.py`)
   - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –§–∞–π–ª–æ–≤–æ–µ –∏ in-memory —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤
   - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π

2. **GoogleSheetsService** (`google_sheets_service.py`)
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
   - –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

3. **Monitoring API** (`monitoring_endpoints.py`)
   - REST API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫ –ø–æ –ª–æ–≥–∞–º
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

## –¢–∏–ø—ã –æ–ø–µ—Ä–∞—Ü–∏–π

```python
class OperationType(Enum):
    CREATE_SHEET = "create_sheet"        # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
    UPDATE_RESULTS = "update_results"    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    GET_URL = "get_url"                  # –ü–æ–ª—É—á–µ–Ω–∏–µ URL —Ç–∞–±–ª–∏—Ü—ã
```

## –°—Ç–∞—Ç—É—Å—ã –æ–ø–µ—Ä–∞—Ü–∏–π

```python
class OperationStatus(Enum):
    SUCCESS = "success"  # –£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
    ERROR = "error"      # –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```

## API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- `GET /api/monitor/google-sheets/status` - –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- `GET /api/monitor/google-sheets/statistics` - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –õ–æ–≥–∏ –∏ –æ—à–∏–±–∫–∏

- `GET /api/monitor/google-sheets/logs` - –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `GET /api/monitor/google-sheets/errors` - –¢–æ–ª—å–∫–æ –ª–æ–≥–∏ —Å –æ—à–∏–±–∫–∞–º–∏
- `DELETE /api/monitor/google-sheets/logs` - –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- `GET /api/monitor/google-sheets/performance` - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```bash
GET /api/monitor/google-sheets/status
```

–û—Ç–≤–µ—Ç:
```json
{
  "status": "active",
  "monitoring_enabled": true,
  "statistics": {
    "total_operations": 150,
    "successful_operations": 142,
    "error_operations": 8,
    "success_rate": 94.67,
    "avg_duration_ms": 245.5
  },
  "timestamp": "2024-01-20T10:30:00"
}
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

```bash
GET /api/monitor/google-sheets/logs?operation_type=create_sheet&status=error&limit=10
```

–û—Ç–≤–µ—Ç:
```json
{
  "logs": [
    {
      "timestamp": "2024-01-20T10:25:00",
      "operation_type": "create_sheet",
      "interview_id": "interview-123",
      "status": "error",
      "duration_ms": 1500,
      "error_message": "Google Sheets API rate limit exceeded",
      "has_stack_trace": true
    }
  ],
  "total_count": 1,
  "filters_applied": {
    "operation_type": "create_sheet",
    "status": "error",
    "hours_back": 24
  }
}
```

### 3. –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```bash
GET /api/monitor/google-sheets/performance?hours=24
```

–û—Ç–≤–µ—Ç:
```json
{
  "performance_metrics": {
    "create_sheet": {
      "total_operations": 45,
      "success_rate": 95.56,
      "avg_duration_ms": 234.5,
      "min_duration_ms": 150,
      "max_duration_ms": 890,
      "median_duration_ms": 220,
      "p95_duration_ms": 456,
      "p99_duration_ms": 678
    }
  }
}
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ FastAPI –ø—Ä–æ–µ–∫—Ç–∞.

### 2. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
cd backend/api
python test_monitoring.py
```

### 3. –ó–∞–ø—É—Å–∫ API —Å–µ—Ä–≤–µ—Ä–∞

```bash
cd backend/api
python main.py
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000`

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger: `http://localhost:8000/docs`

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```python
# –í google_sheets_monitor.py
LOG_FILE_PATH = "logs/google_sheets_operations.log"
MAX_IN_MEMORY_LOGS = 1000
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API

```python
# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–æ–≤
DEFAULT_LOG_LIMIT = 50
MAX_LOG_LIMIT = 1000
DEFAULT_HOURS_BACK = 24
MAX_HOURS_BACK = 168  # 7 –¥–Ω–µ–π
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤

–ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –ª–æ–≥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:

```python
@dataclass
class LogEntry:
    timestamp: datetime           # –í—Ä–µ–º—è –æ–ø–µ—Ä–∞—Ü–∏–∏
    operation_type: OperationType # –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏
    interview_id: str            # ID –∏–Ω—Ç–µ—Ä–≤—å—é
    status: OperationStatus      # –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    duration_ms: Optional[int]   # –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –º—Å
    details: Dict[str, Any]      # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    error_message: Optional[str] # –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
    stack_trace: Optional[str]   # Stack trace –æ—à–∏–±–∫–∏
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### Dashboard endpoints

- `/api/monitor/google-sheets/status` - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
- `/api/monitor/google-sheets/logs?limit=10` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `/api/monitor/google-sheets/errors?hours=1` - –ù–µ–¥–∞–≤–Ω–∏–µ –æ—à–∏–±–∫–∏

### –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –∞–ª–µ—Ä—Ç–æ–≤:

1. **–í—ã—Å–æ–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫** (>10% –∑–∞ —á–∞—Å)
2. **–ú–µ–¥–ª–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** (>1000ms)
3. **–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Google Sheets API**

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets Service

–í—Å–µ –º–µ—Ç–æ–¥—ã `GoogleSheetsService` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º:

```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
await google_sheets_service.create_interview_sheet(interview_id, data)
await google_sheets_service.update_interview_results(interview_id, results)
await google_sheets_service.get_interview_sheet_url(interview_id)
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–ë–∞—Ç—á–µ–≤–∞—è –∑–∞–ø–∏—Å—å** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤
- **In-memory –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–º —Ñ–∞–π–ª–æ–≤

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Stack traces –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –¥–ª—è production
- API endpoints –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç DoS —á–µ—Ä–µ–∑ rate limiting

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
python test_monitoring.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl http://localhost:8000/api/monitor/google-sheets/status
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í–∫–ª—é—á–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

## –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Grafana** –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫
2. **Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö  
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** –ø–æ—Å–ª–µ —Å–±–æ–µ–≤ API
4. **Machine Learning** –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º
5. **–≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫** –≤ Prometheus —Ñ–æ—Ä–º–∞—Ç

---

*–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Google Sheets v1.0 - AI-HR Hackaton 2024*
